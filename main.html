<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>ProStroy · Главная</title>
<style>
  :root{--header:60px;--pad:12px;--green:#1ed760}
  html,body{height:100%;margin:0;color:#fff;font-family:system-ui;overflow:hidden}
  .background{position:fixed;inset:0;z-index:-2}
  .background video{width:100%;height:100%;object-fit:cover}
  /* шапка-контейнер */
  #site-header{position:relative;z-index:1}
  /* левая панель */
  .sidebar{
    position:fixed;left:0;top:calc(var(--header) + var(--pad));bottom:var(--pad);
    width:360px;padding:16px;background:rgba(0,0,0,.55);
    backdrop-filter:blur(12px) saturate(140%);-webkit-backdrop-filter:blur(12px) saturate(140%);
    border:1px solid rgba(255,255,255,.15);border-radius:12px;box-shadow:0 20px 45px rgba(0,0,0,.35);
    overflow:auto;z-index:1
  }
  h2{margin:0 0 10px}
  .nav-links{display:flex;gap:10px;margin-bottom:12px;flex-wrap:wrap}
  .nav-links a{color:#fff;text-decoration:none;padding:8px 10px;border-radius:10px;border:1px solid transparent}
  .nav-links a:hover{border-color:var(--green);background:rgba(30,215,96,.12)}
  .object{background:rgba(255,255,255,.1);border:1px solid rgba(255,255,255,.16);
    padding:12px;border-radius:12px;margin-bottom:10px}
  .status{display:inline-block;margin-top:8px;padding:4px 10px;border-radius:999px;font-size:12px;color:#000}
  .work{background:#1ed760}.prep{background:#ffd166}.agree{background:#7abfff}
  .cta{margin-top:8px}.cta a{display:inline-block;background:var(--green);color:#062410;text-decoration:none;
    padding:10px 14px;border-radius:10px;font-weight:800}
</style>
</head>
<body>
  <!-- фон -->
  <div class="background">
    <video autoplay muted loop playsinline>
      <source src="https://assets.mixkit.co/videos/30431/30431-720.mp4" type="video/mp4">
    </video>
  </div>

  <!-- шапка -->
  <div id="site-header"></div>

  <!-- левый блок -->
  <aside class="sidebar">
    <h2>Добро пожаловать в ProStroy</h2>
    <div class="nav-links">
      <a href="requests.html">Заявки</a>
      <a href="transport.html">Автотранспорт</a>
      <a href="pto.html">ПТО</a>
      <a href="profile.html">Личный кабинет</a>
    </div>

    <div class="object">
      Объект: Склад №7 — Восточный кластер
      <div class="status work">В РАБОТЕ</div>
    </div>
    <div class="object">
      Объект: ЖК «Северный» — Блок Б2
      <div class="status prep">ПОДГОТОВКА</div>
    </div>
    <div class="object">
      Объект: Транспортный узел — Секция 3
      <div class="status agree">СОГЛАСОВАНИЕ</div>
    </div>

    <div class="cta"><a href="transport.html">+ Новая заявка на автотранспорт</a></div>
  </aside>

  <!-- скрипты -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <script>
    const SB_URL="https://hvpbwpegxcbstmpngdyc.supabase.co";
    const SB_ANON="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh2cGJ3cGVneGNic3RtcG5nZHljIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg2NDE4NjMsImV4cCI6MjA3NDIxNzg2M30.rtPrQVsaEFA-ee1RphLKKn8q3TSOXeapZnZgfe9HVws";
    const supa = window.supabase.createClient(SB_URL, SB_ANON, { auth:{ persistSession:false } });

    // запрет "назад" к авторизации после входа
    history.replaceState(null,'',location.href);

    (async ()=>{
      const { data:{ session } } = await supa.auth.getSession();
      if(!session){ location.href = 'index.html'; return; }
      // покажем email в шапке (элемент #who)
      const who = document.getElementById('who'); if (who) who.textContent = session.user.email;
      // кнопка выйти (если шапка уже подгрузилась)
      document.getElementById('btnLogout')?.addEventListener('click', async (e)=>{
        e.preventDefault(); await supa.auth.signOut(); location.replace('index.html');
      });
    })();
  </script>
  <script src="header.js"></script>
  <script>loadHeader('site-header');</script>
</body>
</html>
