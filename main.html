<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ProStroy — Главная</title>
<style>
  :root{
    --bg:#0b1220;        /* тёмный фон вокруг */
    --text:#eef3f9;      /* белый текст */
    --muted:#9fb0c9;     /* приглушённый */
    --green:#22c55e;     /* зелёный акцент */
    --panel:#111a2c;     /* панели */
    --glass:rgba(255,255,255,.08);
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui}

  /* контейнер header'а (подтянется через header.js → loadHeader) */
  #site-header{position:relative;z-index:5}

  /* герой-секция с фоном */
  .hero{
    position:relative;
    min-height:calc(100vh - 60px);
    overflow:hidden;
    isolation:isolate; /* чтобы overlay работал поверх изображения */
  }
  .hero img.bg{
    position:absolute; inset:0;
    width:100%; height:100%; object-fit:cover;
    filter:contrast(1.05) saturate(1.08);
    opacity:.9;
    z-index:0;
  }
  .hero::after{
    /* затемняем картинку */
    content:"";
    position:absolute; inset:0;
    background:linear-gradient(0deg, rgba(0,0,0,.55), rgba(0,0,0,.45));
    z-index:1;
  }

  /* левый блок поверх фото */
  .left-panel{
    position:relative; z-index:2;
    max-width:560px;
    margin:24px;
    padding:18px;
    background:var(--glass);
    backdrop-filter: blur(12px) saturate(140%);
    -webkit-backdrop-filter: blur(12px) saturate(140%);
    border:1px solid rgba(255,255,255,.15);
    border-radius:16px;
    box-shadow:0 20px 45px rgba(0,0,0,.35);
  }
  .left-panel h1{
    margin:0 0 6px 0; font-size:32px; font-weight:900;
    letter-spacing:.2px; text-shadow:0 2px 10px rgba(0,0,0,.4);
  }
  .subtitle{margin:0 0 14px 0; color:var(--muted)}

  /* быстрые плитки-ссылки */
  .quick{
    display:grid;
    grid-template-columns: repeat(3, minmax(0,1fr));
    gap:10px; margin:12px 0 6px;
  }
  .tile{
    background:rgba(255,255,255,.10);
    border:1px solid rgba(255,255,255,.16);
    border-radius:12px;
    padding:12px;
    text-decoration:none; color:var(--text);
    display:flex; flex-direction:column; gap:6px;
  }
  .tile:hover{ outline:2px solid var(--green) }
  .tile .t{font-weight:800}
  .tile .d{color:var(--muted); font-size:13px; line-height:1.2}

  /* список объектов (демо) */
  .objects{margin-top:12px; display:grid; gap:10px}
  .obj{
    padding:10px 12px; border-radius:10px; background:rgba(0,0,0,.28);
    display:flex; align-items:center; justify-content:space-between;
    border:1px solid rgba(255,255,255,.16);
  }
  .obj b{letter-spacing:.2px}
  .badge{
    background:#24324d; padding:3px 8px; border-radius:999px;
    font-size:12px; text-transform:uppercase;
  }
  .cta{margin-top:12px}
  .cta a{
    display:inline-block; background:var(--green); color:#062410;
    font-weight:900; padding:10px 14px; border-radius:10px; text-decoration:none;
  }
  .cta a:hover{filter:brightness(1.05)}
</style>
</head>
<body>
  <!-- общий верхний бар -->
  <div id="site-header"></div>

  <!-- фон с фото стройки и левым блоком -->
  <section class="hero">
    <img class="bg" src="https://images.unsplash.com/photo-1581090464777-f3220bbe1b8b?auto=format&fit=crop&w=1600&q=80" alt="Стройка">
    <div class="left-panel">
      <h1>Добро пожаловать в ProStroy</h1>
      <p class="subtitle">Быстрые действия и актуальные объекты</p>

      <!-- быстрые плитки -->
      <div class="quick">
        <a class="tile" href="requests.html">
          <span class="t">Заявки</span>
          <span class="d">Список и статусы</span>
        </a>
        <a class="tile" href="transport.html">
          <span class="t">Автотранспорт</span>
          <span class="d">Создать заявку</span>
        </a>
        <a class="tile" href="profile.html">
          <span class="t">Личный кабинет</span>
          <span class="d" id="u-short">Профиль пользователя</span>
        </a>
      </div>

      <!-- объекты (демо-список) -->
      <div class="objects">
        <div class="obj">
          <div><b>Объект: Склад №7</b> — Восточный кластер</div>
          <span class="badge">в работе</span>
        </div>
        <div class="obj">
          <div><b>Объект: ЖК «Северный»</b> — Блок Б2</div>
          <span class="badge">подготовка</span>
        </div>
        <div class="obj">
          <div><b>Объект: Транспортный узел</b> — Секция 3</div>
          <span class="badge">согласование</span>
        </div>
      </div>

      <div class="cta">
        <a href="transport.html">+ Новая заявка на автотранспорт</a>
      </div>
    </div>
  </section>

  <!-- подключаем общий header.js и запускаем -->
  <script src="header.js"></script>
  <script>
    (async ()=>{
      // если не авторизован — отправим на страницу входа
      try{
        const { data:{ user } } = await supa.auth.getUser();
        if (!user) { location.href = "index.html"; return; }
        await loadHeader(); // подтянет header.html и покажет email

        // короткая подсказка в плитке профиля
        const short = document.getElementById('u-short');
        if (short && user?.email) short.textContent = user.email;
      }catch(e){
        // если supa не определён (например, header.js не загрузился) — мягкий редирект
        location.href = "index.html";
      }
    })();
  </script>
</body>
</html>
